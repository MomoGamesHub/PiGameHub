<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>PiGameHub â€“ Domino Online</title>

<style>
body{margin:0;font-family:Arial;background:#1b1b2f;color:#fff;text-align:center}
.screen{display:none;padding:20px}
button,input{padding:10px;margin:10px;font-size:16px}
#game-layout{display:grid;grid-template-columns:120px 1fr 120px;align-items:center;margin:20px}
.outer-pile{display:flex;flex-direction:column;gap:6px;align-items:center}
.pile-tile{width:40px;height:20px;background:#555;border-radius:4px}
#board{display:flex;flex-direction:column;gap:8px;align-items:center}
.tile{width:40px;height:60px;background:#eee;color:#000;border-radius:6px;
display:flex;flex-direction:column;justify-content:space-between;
padding:4px;font-weight:bold;cursor:pointer}
.tile.hidden{background:#333;cursor:default}
.hand{display:flex;justify-content:center;gap:8px;margin:10px}
.avatar-card{width:80px;height:80px;background:#444;border-radius:8px;
display:inline-flex;align-items:center;justify-content:center;
font-size:30px;margin:10px;cursor:pointer}
.avatar-card.selected{border:3px solid yellow}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login-screen" class="screen">
  <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
  <input id="email" placeholder="Email">
  <input id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„">
  <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
</div>

<!-- AVATAR -->
<div id="avatar-screen" class="screen">
  <h2>Ø§Ø®ØªØ± Ø´Ø®ØµÙŠØªÙƒ</h2>
  <div id="avatar-container"></div>
  <button onclick="startGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
</div>

<!-- GAME -->
<div id="game-screen" class="screen">
  <h2>ğŸ« Domino Online</h2>

  <button onclick="createRoom()">ğŸ® Create Online Room</button>

  <div id="game-layout">
    <div id="left-pile" class="outer-pile"></div>
    <div id="board"></div>
    <div id="right-pile" class="outer-pile"></div>
  </div>

  <h3>ÙŠØ¯ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±</h3>
  <div id="computer-hand" class="hand"></div>

  <h3>ÙŠØ¯Ùƒ</h3>
  <div id="player-hand" class="hand"></div>

  <button onclick="drawTile()">Ø§Ø³Ø­Ø¨ Ù‚Ø·Ø¹Ø©</button>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
// ================= FIREBASE CONFIG =================
const firebaseConfig = {
  apiKey: "PUT_YOUR_KEY",
  authDomain: "PUT_YOUR_DOMAIN",
  databaseURL: "PUT_YOUR_DB_URL",
  projectId: "PUT_YOUR_PROJECT_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ================= LOGIN =================
function login(){
  if(email.value || phone.value){
    document.getElementById("login-screen").style.display="none";
    document.getElementById("avatar-screen").style.display="block";
    setupAvatars();
  }else alert("Ø§Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª");
}

// ================= AVATAR =================
let selectedAvatar=null;
function setupAvatars(){
  const avatars=["ğŸ™‚","ğŸ˜","ğŸ§‘"];
  const c=document.getElementById("avatar-container");
  c.innerHTML="";
  avatars.forEach(a=>{
    let d=document.createElement("div");
    d.className="avatar-card";
    d.innerText=a;
    d.onclick=()=>{
      document.querySelectorAll(".avatar-card").forEach(x=>x.classList.remove("selected"));
      d.classList.add("selected");
      selectedAvatar=a;
    };
    c.appendChild(d);
  });
}

// ================= GAME VARS =================
let tiles=[],pile=[],board=[],left=null,right=null;
let playerHand=[],computerHand=[];

// ================= START =================
function startGame(){
  if(!selectedAvatar) return alert("Ø§Ø®ØªØ± Ø´Ø®ØµÙŠØ©");
  document.getElementById("avatar-screen").style.display="none";
  document.getElementById("game-screen").style.display="block";
  initGame();
}

function initGame(){
  tiles=[]; board=[]; left=null; right=null;

  for(let i=0;i<=6;i++)
    for(let j=i;j<=6;j++)
      tiles.push([i,j]);

  tiles.sort(()=>Math.random()-0.5);
  playerHand=tiles.splice(0,7);
  computerHand=tiles.splice(0,7);
  pile=[...tiles];

  renderAll();
}

// ================= ONLINE â€“ STAGE 1 =================
function createRoom(){
  const roomId=Math.random().toString(36).substring(2,7);
  db.ref("rooms/"+roomId).set({
    created:Date.now(),
    board:[],
    status:"waiting"
  });
  alert("Room Created âœ…\nRoom ID: "+roomId);
}

// ================= GAME LOGIC =================
function play(a,b){
  if(left===null){board.push([a,b]); left=a; right=b; return true;}
  if(a===right){board.push([a,b]); right=b; return true;}
  if(b===left){board.unshift([a,b]); left=a; return true;}
  return false;
}

function playerTurn(i){
  let [a,b]=playerHand[i];
  if(play(a,b)||play(b,a)){
    playerHand.splice(i,1);
    renderAll();
  }else alert("Ù…Ø´ Ù†Ø§ÙØ¹");
}

function drawTile(){
  if(pile.length){
    playerHand.push(pile.shift());
    renderAll();
  }else alert("Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ÙØ§Ø¶ÙŠ");
}

// ================= RENDER =================
const boardDiv=document.getElementById("board");
const playerDiv=document.getElementById("player-hand");
const computerDiv=document.getElementById("computer-hand");
const leftPile=document.getElementById("left-pile");
const rightPile=document.getElementById("right-pile");

function renderTile([a,b],hidden=false){
  let d=document.createElement("div");
  d.className="tile"+(hidden?" hidden":"");
  if(!hidden) d.innerHTML=`<div>${a}</div><div>${b}</div>`;
  return d;
}

function renderAll(){
  boardDiv.innerHTML="";
  board.forEach(t=>boardDiv.appendChild(renderTile(t)));

  playerDiv.innerHTML="";
  playerHand.forEach((t,i)=>{
    let d=renderTile(t);
    d.onclick=()=>playerTurn(i);
    playerDiv.appendChild(d);
  });

  computerDiv.innerHTML="";
  computerHand.forEach(()=>computerDiv.appendChild(renderTile([0,0],true)));

  leftPile.innerHTML=rightPile.innerHTML="";
  pile.forEach(()=>leftPile.appendChild(document.createElement("div")).className="pile-tile");
}

// ================= INIT =================
document.getElementById("login-screen").style.display="block";
</script>

</body>
</html>
