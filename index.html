<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PiGamesHub | Pioneer Edition</title>
    <style>
        :root {
            --primary: #6741d9;
            --pi-gold: #ffd700;
            --dark: #05010a;
            --glow: 0 0 20px rgba(103, 65, 217, 0.6);
        }

        body, html { margin: 0; padding: 0; background: var(--dark); color: white; font-family: 'Segoe UI', sans-serif; height: 100vh; overflow: hidden; }

        /* Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠØ© */
        .universe-bg { position: fixed; inset: 0; background: radial-gradient(circle at center, #1a0b35 0%, #05010a 100%); z-index: -1; }
        .waves { position: fixed; width: 200%; height: 200%; background: radial-gradient(circle at 30% 30%, rgba(103,65,217,0.1), transparent 50%); animation: rotate 30s linear infinite; z-index: -1; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* Ø²Ø± Ø¯Ø®ÙˆÙ„ Pi Ø§Ù„Ù„Ø§Ù…Ø¹ */
        .pi-btn {
            background: linear-gradient(45deg, var(--primary), #8e44ad);
            border: 2px solid var(--pi-gold); color: white; padding: 10px 25px;
            border-radius: 50px; font-weight: bold; cursor: pointer;
            box-shadow: var(--glow); animation: glow-pulse 2s infinite;
        }
        @keyframes glow-pulse { 0%, 100% { box-shadow: 0 0 10px var(--primary); } 50% { box-shadow: 0 0 25px var(--pi-gold); } }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø³ØªØ© Ø§Ù„ÙØ®Ù…Ø© */
        .main-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; padding: 25px; max-width: 500px; margin: 40px auto; }
        .game-card { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1); border-radius: 30px; padding: 25px 10px; text-align: center; backdrop-filter: blur(10px); transition: 0.4s; cursor: pointer; }
        .game-card:hover { border-color: var(--pi-gold); transform: translateY(-10px); box-shadow: var(--glow); }
        .game-card img { width: 80px; filter: drop-shadow(0 8px 15px rgba(0,0,0,0.5)); animation: float 4s infinite ease-in-out; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ùˆ Ø¨Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© */
        .domino-piece {
            width: 42px; height: 84px; background: #fff; border: 3px solid #222;
            border-radius: 8px; display: flex; flex-direction: column; box-shadow: 0 4px 8px rgba(0,0,0,0.5);
        }
        .half { flex: 1; display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(3, 1fr); padding: 5px; gap: 3px; }
        .dot { background: #111; border-radius: 50%; width: 7px; height: 7px; visibility: hidden; margin: auto; }
        .v-1 .d5, .v-3 .d5, .v-5 .d5 { visibility: visible; }
        .v-2 .d1, .v-2 .d9, .v-3 .d1, .v-3 .d9, .v-4 .d1, .v-4 .d3, .v-4 .d7, .v-4 .d9, .v-5 .d1, .v-5 .d3, .v-5 .d7, .v-5 .d9, .v-6 .d1, .v-6 .d3, .v-6 .d4, .v-6 .d6, .v-6 .d7, .v-6 .d9 { visibility: visible; }

        /* Ø§Ù„Ø·Ø§ÙˆÙ„Ø© ÙˆØ§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø°ÙƒÙŠ */
        #game-screen { display: none; position: fixed; inset: 0; background: radial-gradient(circle, #0a3d1d 0%, #051a0d 100%); z-index: 2000; flex-direction: column; }
        .table-center { flex-grow: 1; position: relative; border: 12px solid #2c1e14; margin: 10px; border-radius: 20px; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        #board-snake { display: flex; flex-wrap: wrap; justify-content: center; align-content: center; gap: 10px; width: 85%; padding: 20px; }

        /* Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .back-btn { background: none; border: 1px solid var(--pi-gold); color: var(--pi-gold); padding: 5px 15px; border-radius: 10px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="universe-bg"></div>
    <div class="waves"></div>

    <div id="home-ui">
        <header style="padding: 20px; display: flex; justify-content: space-between; align-items: center;">
            <div style="font-size: 1.8rem; font-weight: 900; color: var(--pi-gold);">PiGamesHub</div>
            <button class="pi-btn">Ø¯Ø®ÙˆÙ„ $\pi$</button>
        </header>
        <div class="main-grid">
            <div class="game-card" onclick="showLobby()"><img src="domino.png.png"><div>Ø¯ÙˆÙ…ÙŠÙ†Ùˆ</div></div>
            <div class="game-card"><img src="chess.png.png"><div>Ø´Ø·Ø±Ù†Ø¬</div></div>
            <div class="game-card"><img src="ludo.png.png"><div>Ù„ÙˆØ¯Ùˆ</div></div>
            <div class="game-card"><img src="cards.png.png"><div>ÙƒÙˆØªØ´ÙŠÙ†Ø©</div></div>
            <div class="game-card"><img src="tawla31.png.png"><div>Ø·Ø§ÙˆÙ„Ø© 31</div></div>
            <div class="game-card"><img src="nerd.png.png"><div>Ø§Ù„Ù†Ø±Ø¯</div></div>
        </div>
    </div>

    <div id="lobby" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.95); z-index:1500; flex-direction:column; align-items:center; justify-content:center;">
        <button class="back-btn" style="position:absolute; top:40px; right:40px;" onclick="hideLobby()">ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <h2 style="color:var(--pi-gold);">Ø§Ø®ØªØ± Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ùˆ</h2>
        <div style="display:flex; flex-direction:column; gap:15px; width:300px;">
            <div class="game-card" onclick="startGame()">Ø¯ÙˆÙ…ÙŠÙ†Ùˆ Ø¹Ø§Ø¯ÙŠØ© (101 Ù†Ù‚Ø·Ø©)</div>
            <div class="game-card">Ø¯ÙˆÙ…ÙŠÙ†Ùˆ Ø£Ù…Ø±ÙŠÙƒØ§Ù†ÙŠ</div>
            <div class="game-card">Ø¯ÙˆÙ…ÙŠÙ†Ùˆ Ø³Ø±ÙŠØ¹</div>
        </div>
    </div>

    <div id="game-screen">
        <div style="padding:10px; background:var(--primary); display:flex; justify-content:space-between;">
            <span id="status">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
            <button onclick="location.reload()" style="background:red; border:none; color:white; border-radius:5px;">Ø§Ù†Ø³Ø­Ø§Ø¨</button>
        </div>
        <div class="table-center">
            <div id="board-snake"></div>
        </div>
        <div id="player-hand" style="height:140px; background:rgba(0,0,0,0.85); display:flex; justify-content:center; align-items:center; gap:10px; padding:10px; border-top:2px solid var(--pi-gold); overflow-x:auto;"></div>
    </div>

    <script>
        let hand = [], board = [], turn = 0, players = [[], [], [], []];

        function showLobby() { document.getElementById('lobby').style.display = 'flex'; }
        function hideLobby() { document.getElementById('lobby').style.display = 'none'; }

        function createTileHTML(v1, v2) {
            const dots = '<div class="dot d1"></div><div class="dot d2"></div><div class="dot d3"></div><div class="dot d4"></div><div class="dot d5"></div><div class="dot d6"></div><div class="dot d7"></div><div class="dot d8"></div><div class="dot d9"></div>';
            return `<div class="domino-piece">
                <div class="half v-${v1}">${dots}</div>
                <div style="height:2px; background:#333;"></div>
                <div class="half v-${v2}">${dots}</div>
            </div>`;
        }

        function startGame() {
            document.getElementById('lobby').style.display = 'none';
            document.getElementById('home-ui').style.display = 'none';
            document.getElementById('game-screen').style.display = 'flex';
            
            let deck = [];
            for(let i=0; i<=6; i++) for(let j=i; j<=6; j++) deck.push([i, j]);
            deck.sort(() => Math.random() - 0.5);
            for(let p=0; p<4; p++) players[p] = deck.splice(0, 7);
            
            renderHand();
            processTurn();
        }

        function renderHand() {
            const container = document.getElementById('player-hand');
            container.innerHTML = "";
            players[0].forEach((t, i) => {
                const div = document.createElement('div');
                div.innerHTML = createTileHTML(t[0], t[1]);
                div.onclick = () => tryMove(0, i);
                container.appendChild(div);
            });
        }

        function tryMove(pIdx, tIdx) {
            if(turn !== pIdx) return;
            const tile = players[pIdx][tIdx];
            if(board.length === 0) executeMove(tile, pIdx, tIdx);
            else {
                let L = board[0][0], R = board[board.length-1][1];
                if(tile.includes(L) || tile.includes(R)) executeMove(tile, pIdx, tIdx);
            }
        }

        function executeMove(tile, pIdx, tIdx) {
            if(board.length === 0) board.push(tile);
            else {
                let L = board[0][0], R = board[board.length-1][1];
                if(tile.includes(L)) board.unshift(tile[1] === L ? tile : [tile[1], tile[0]]);
                else board.push(tile[0] === R ? tile : [tile[1], tile[0]]);
            }
            players[pIdx].splice(tIdx, 1);
            updateBoardUI();
            renderHand();
            turn = (turn + 1) % 4;
            processTurn();
        }

        function updateBoardUI() {
            const b = document.getElementById('board-snake');
            b.innerHTML = "";
            board.forEach(t => {
                const wrap = document.createElement('div');
                wrap.style.transform = "rotate(90deg) scale(0.85)";
                wrap.innerHTML = createTileHTML(t[0], t[1]);
                b.appendChild(wrap);
            });
        }

        function processTurn() {
            document.getElementById('status').innerText = turn === 0 ? "Ø¯ÙˆØ±Ùƒ Ø§Ù„Ø¢Ù†" : `ØªÙÙƒÙŠØ± Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± ${turn}...`;
            if(turn !== 0) {
                setTimeout(() => {
                    let L = board[0][0], R = board[board.length-1][1];
                    let idx = players[turn].findIndex(t => board.length===0 || t.includes(L) || t.includes(R));
                    if(idx !== -1) tryMove(turn, idx);
                    else { turn = (turn + 1) % 4; processTurn(); }
                }, 1200);
            }
        }
    </script>
</body>
</html>
