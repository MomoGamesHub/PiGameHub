<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pi Game Hub</title>
    <script src="https://sdk.minepi.com/pi-sdk.js"></script>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f9; margin: 0; padding: 0; text-align: center; }
        .header { background: #673ab7; color: white; padding: 20px; border-bottom-left-radius: 20px; border-bottom-right-radius: 20px; }
        .container { padding: 20px; }
        /* Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø¨Ø¹Ø§Øª Ù„Ù„Ø£Ù„Ø¹Ø§Ø¨ */
        .game-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .game-card { background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); cursor: pointer; transition: 0.3s; border: 1px solid #eee; }
        .game-card:active { transform: scale(0.95); }
        .game-card img { width: 50px; height: 50px; margin-bottom: 10px; }
        .game-card h4 { margin: 10px 0 5px; color: #333; }
        .game-card p { font-size: 12px; color: #777; margin: 0; }
        .btn-login { background: #673ab7; color: white; border: none; padding: 15px 40px; border-radius: 30px; font-size: 18px; margin-top: 50px; cursor: pointer; }
        #main-interface { display: none; }
        .price-tag { color: #673ab7; font-weight: bold; font-size: 14px; }
    </style>
</head>
<body>

    <div class="header">
        <h1>Ø£Ù„Ø¹Ø§Ø¨ Ø¨Ø§ÙŠ Ø§Ù„Ø°ÙƒÙŠØ©</h1>
        <p id="user-status">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ø¬ØªÙ…Ø¹ PiOS</p>
    </div>

    <div id="login-screen" class="container">
        <p>Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± Ù…ØªØµÙØ­ Pi Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨</p>
        <button class="btn-login" onclick="login()">Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù† Ø¹Ø¨Ø± Pi</button>
    </div>

    <div id="main-interface" class="container">
        <h3>Ø§Ø®ØªØ± ØªØ­Ø¯ÙŠ Ø§Ù„ÙŠÙˆÙ… ğŸš€</h3>
        <div class="game-grid">
            
            <div class="game-card" onclick="handlePayment('sudoku', 0.1)">
                <img src="https://cdn-icons-png.flaticon.com/512/517/517505.png" alt="sudoku">
                <h4>Ø³ÙˆØ¯ÙˆÙƒÙˆ</h4>
                <p class="price-tag">0.1 Pi</p>
            </div>

            <div class="game-card" onclick="handlePayment('domino', 0.1)">
                <img src="https://cdn-icons-png.flaticon.com/512/2388/2388040.png" alt="domino">
                <h4>Ø¯ÙˆÙ…ÙŠÙ†Ùˆ</h4>
                <p class="price-tag">0.1 Pi</p>
            </div>

            <div class="game-card" onclick="alert('Ù‚Ø±ÙŠØ¨Ø§Ù‹...')">
                <img src="https://cdn-icons-png.flaticon.com/512/3406/3406828.png" alt="quiz">
                <h4>Ø§Ø®ØªØ¨Ø§Ø± Ø°ÙƒØ§Ø¡</h4>
                <p>Ù‚Ø±ÙŠØ¨Ø§Ù‹</p>
            </div>

        </div>
    </div>

    <script>
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù€ SDK
        Pi.init({ version: "2.0", sandbox: true });

        function login() {
            Pi.authenticate(['payments', 'username'], onIncompletePaymentFound)
            .then(function(auth) {
                document.getElementById('user-status').innerText = "Ù…Ø±Ø­Ø¨Ø§Ù‹: " + auth.user.username;
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('main-interface').style.display = 'block';
            })
            .catch(function(error) {
                console.error(error);
                alert("Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„. ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ Ø¯Ø§Ø®Ù„ Ù…ØªØµÙØ­ Pi");
            });
        }

        function handlePayment(gameName, amount) {
            const paymentData = {
                amount: amount,
                memo: "ÙØªØ­ Ù„Ø¹Ø¨Ø© " + gameName,
                metadata: { game: gameName }
            };

            const callbacks = {
                onReadyForServerApproval: function(paymentId) {
                    fetch('/api/pi-handler', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ paymentId, action: 'approve' })
                    });
                },
                onReadyForServerCompletion: function(paymentId, txid) {
                    fetch('/api/pi-handler', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ paymentId, action: 'complete', txid })
                    }).then(() => {
                        alert("ØªÙ… Ø§Ù„Ø¯ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­! Ø§Ø³ØªÙ…ØªØ¹ÙŠ Ø¨Ù€ " + gameName);
                        // Ù‡Ù†Ø§ Ù†ÙØªØ­ Ø§Ù„Ù„Ø¹Ø¨Ø©
                    });
                },
                onCancel: function(paymentId) { console.log("Cancelled"); },
                onError: function(error, payment) { console.error(error); }
            };

            Pi.createPayment(paymentData, callbacks);
        }

        function onIncompletePaymentFound(payment) {
            // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        }
    </script>
</body>
</html>
