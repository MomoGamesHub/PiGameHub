<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PiGamesHub | Pioneer Edition</title>
    <style>
        :root {
            --primary-purple: #6741d9;
            --pi-gold: #ffd700;
            --bg-dark: #05010a;
            --table-green: #0a3d1d;
        }

        body, html { margin: 0; padding: 0; background: var(--bg-dark); color: white; font-family: 'Segoe UI', sans-serif; height: 100vh; overflow: hidden; }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± ÙˆØ²Ø± Pi Ø§Ù„Ù…ØªÙˆÙ‡Ø¬ */
        header { padding: 15px 5%; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .pi-login { 
            background: linear-gradient(45deg, var(--primary-purple), #4b2cb3);
            border: 2px solid var(--pi-gold); color: white; padding: 8px 18px;
            border-radius: 20px; cursor: pointer; font-weight: bold;
            box-shadow: 0 0 10px var(--primary-purple); animation: glow 2s infinite;
        }
        @keyframes glow { 0%, 100% { box-shadow: 0 0 5px var(--primary-purple); } 50% { box-shadow: 0 0 20px var(--pi-gold); } }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ (Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„ØµÙˆØ±Ø©) */
        .hub-grid { 
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; 
            max-width: 400px; margin: 40px auto; padding: 20px;
            background: rgba(255,255,255,0.03); border-radius: 30px;
        }
        .game-item { 
            background: rgba(255,255,255,0.05); border-radius: 20px; padding: 15px; 
            text-align: center; border: 1px solid rgba(255,255,255,0.1); cursor: pointer; transition: 0.3s;
        }
        .game-item:hover { border-color: var(--pi-gold); transform: scale(1.05); }
        .game-item img { width: 60px; height: 60px; object-fit: contain; margin-bottom: 8px; }

        /* Ø´Ø§Ø´Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù†Ø¸Ø§Ù… (Lobby) */
        #lobby { 
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.96); 
            z-index: 1000; flex-direction: column; align-items: center; justify-content: center; 
        }
        .lobby-btn { 
            width: 280px; padding: 15px; margin: 10px; background: rgba(103,65,217,0.2); 
            border: 1px solid var(--primary-purple); border-radius: 15px; color: white; cursor: pointer; font-size: 1rem;
        }
        .back-home { position: absolute; top: 20px; right: 20px; color: var(--pi-gold); cursor: pointer; background: none; border: 1px solid var(--pi-gold); padding: 5px 15px; border-radius: 10px; }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø·Ø§ÙˆÙ„Ø© ÙˆØ§Ù„Ù‚Ø·Ø¹ (Ø§Ù„Ù†Ù‚Ø§Ø· Dots) */
        #game-view { display: none; position: fixed; inset: 0; background: var(--table-green); z-index: 500; flex-direction: column; }
        .game-board { flex: 1; padding: 20px; display: flex; flex-wrap: wrap; align-content: center; justify-content: center; gap: 10px; overflow-y: auto; }
        
        .domino { 
            width: 40px; height: 80px; background: #fff; border: 2px solid #222; 
            border-radius: 6px; display: flex; flex-direction: column; transform: rotate(90deg); flex-shrink: 0;
        }
        .half { flex: 1; display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(3, 1fr); padding: 3px; }
        .dot { background: #000; border-radius: 50%; width: 6px; height: 6px; visibility: hidden; margin: auto; }
        
        /* Ù…Ù†Ø·Ù‚ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù†Ù‚Ø§Ø· */
        .v1 .d5, .v3 .d5, .v5 .d5 { visibility: visible; }
        .v2 .d1, .v2 .d9, .v3 .d1, .v3 .d9, .v4 .d1, .v4 .d3, .v4 .d7, .v4 .d9, .v5 .d1, .v5 .d3, .v5 .d7, .v5 .d9, .v6 .d1, .v6 .d3, .v6 .d4, .v6 .d6, .v6 .d7, .v6 .d9 { visibility: visible; }

        #player-hand { height: 130px; background: rgba(0,0,0,0.9); display: flex; justify-content: center; align-items: center; gap: 8px; border-top: 2px solid var(--pi-gold); }
    </style>
</head>
<body>

    <div id="main-ui">
        <header>
            <div style="color:var(--pi-gold); font-weight:bold;">PiGamesHub</div>
            <button class="pi-login">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ $ \pi $</button>
        </header>
        <div style="text-align:center; margin-top:30px;">
            <h1 style="font-size:1.5rem;">Ù…Ø³ØªÙ‚Ø¨Ù„ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø¨ÙŠÙ† ÙŠØ¯ÙŠÙƒ</h1>
            <p style="font-size:0.8rem; color:#aaa;">Ø§Ø³ØªÙ…ØªØ¹ Ø¨ØªØ¬Ø±Ø¨Ø© Ø£Ù„Ø¹Ø§Ø¨ ÙˆÙŠØ¨ 3 Ø¹Ù„Ù‰ Ø´Ø¨ÙƒØ© Pi Network</p>
        </div>
        <div class="hub-grid">
            <div class="game-item" onclick="openLobby()"><img src="domino.png.png"><div>Ø¯ÙˆÙ…ÙŠÙ†Ùˆ</div></div>
            <div class="game-item"><img src="chess.png.png"><div>Ø´Ø·Ø±Ù†Ø¬</div></div>
            <div class="game-item"><img src="ludo.png.png"><div>Ù„ÙˆØ¯Ùˆ</div></div>
            <div class="game-item"><img src="cards.png.png"><div>ÙƒÙˆØªØ´ÙŠÙ†Ø©</div></div>
            <div class="game-item"><img src="tawla31.png.png"><div>Ø·Ø§ÙˆÙ„Ø© 31</div></div>
            <div class="game-item"><img src="nerd.png.png"><div>Ø§Ù„Ù†Ø±Ø¯</div></div>
        </div>
    </div>

    <div id="lobby">
        <button class="back-home" onclick="closeLobby()">ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <h2 style="color:var(--pi-gold); margin-bottom:20px;">Ø§Ø®ØªØ± Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ùˆ</h2>
        <button class="lobby-btn" onclick="startGame()">Ø¯ÙˆÙ…ÙŠÙ†Ùˆ Ø¹Ø§Ø¯ÙŠØ© (101 Ù†Ù‚Ø·Ø©)</button>
        <button class="lobby-btn">Ø¯ÙˆÙ…ÙŠÙ†Ùˆ Ø£Ù…Ø±ÙŠÙƒØ§Ù†ÙŠ</button>
        <button class="lobby-btn">Ø¯ÙˆÙ…ÙŠÙ†Ùˆ Ø³Ø±ÙŠØ¹ (Ø¯ÙˆØ± ÙˆØ§Ø­Ø¯)</button>
    </div>

    <div id="game-view">
        <div style="padding:10px; background:#111; display:flex; justify-content:space-between;">
            <span id="turn-txt" style="color:var(--pi-gold);">Ø¯ÙˆØ±Ùƒ Ø§Ù„Ø¢Ù†</span>
            <button onclick="location.reload()" style="background:red; color:white; border:none; padding:2px 10px; border-radius:5px;">Ø®Ø±ÙˆØ¬</button>
        </div>
        <div class="game-board" id="board"></div>
        <div id="player-hand"></div>
    </div>

    <script>
        let hand = [], board = [], turn = 0, cpuPlayers = [[], [], []];

        function openLobby() { document.getElementById('lobby').style.display = 'flex'; }
        function closeLobby() { document.getElementById('lobby').style.display = 'none'; }

        function createTileHTML(v1, v2) {
            let dots = '<div class="dot d1"></div><div class="dot d2"></div><div class="dot d3"></div><div class="dot d4"></div><div class="dot d5"></div><div class="dot d6"></div><div class="dot d7"></div><div class="dot d8"></div><div class="dot d9"></div>';
            return `<div class="domino">
                <div class="half v${v1}">${dots}</div>
                <div style="height:1px; background:#ddd;"></div>
                <div class="half v${v2}">${dots}</div>
            </div>`;
        }

        function startGame() {
            document.getElementById('lobby').style.display = 'none';
            document.getElementById('main-ui').style.display = 'none';
            document.getElementById('game-view').style.display = 'flex';
            
            let deck = [];
            for(let i=0; i<=6; i++) for(let j=i; j<=6; j++) deck.push([i, j]);
            deck.sort(() => Math.random() - 0.5);
            
            hand = deck.splice(0, 7);
            for(let i=0; i<3; i++) cpuPlayers[i] = deck.splice(0, 7);
            
            updateUI();
        }

        function updateUI() {
            const hDiv = document.getElementById('player-hand');
            hDiv.innerHTML = "";
            hand.forEach((t, i) => {
                let div = document.createElement('div');
                div.innerHTML = createTileHTML(t[0], t[1]);
                div.style.transform = "rotate(0deg)"; // Ø§Ù„ÙŠØ¯ ØªØ¸Ù‡Ø± Ø±Ø£Ø³ÙŠØ©
                div.onclick = () => playTile(i);
                hDiv.appendChild(div);
            });
        }

        function playTile(idx) {
            if(turn !== 0) return;
            let t = hand[idx];
            // Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø¨Ø³ÙŠØ·Ø© Ù„Ù„ØªØ­Ù‚Ù‚
            if(board.length === 0) board.push(t);
            else {
                let L = board[0][0], R = board[board.length-1][1];
                if(t.includes(L)) board.unshift(t[1] === L ? t : [t[1], t[0]]);
                else if(t.includes(R)) board.push(t[0] === R ? t : [t[1], t[0]]);
                else return;
            }
            hand.splice(idx, 1);
            refreshBoard();
            updateUI();
            turn = 1;
            setTimeout(cpuPlay, 1000);
        }

        function refreshBoard() {
            const bDiv = document.getElementById('board');
            bDiv.innerHTML = "";
            board.forEach(t => {
                let div = document.createElement('div');
                div.className = "domino";
                div.innerHTML = createTileHTML(t[0], t[1]);
                bDiv.appendChild(div);
            });
        }

        function cpuPlay() {
            // Ù…Ù†Ø·Ù‚ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…Ø¨Ø³Ø·
            let L = board[0][0], R = board[board.length-1][1];
            let pIdx = turn - 1;
            let tIdx = cpuPlayers[pIdx].findIndex(t => t.includes(L) || t.includes(R));
            
            if(tIdx !== -1) {
                let t = cpuPlayers[pIdx][tIdx];
                if(t.includes(L)) board.unshift(t[1] === L ? t : [t[1], t[0]]);
                else board.push(t[0] === R ? t : [t[1], t[0]]);
                cpuPlayers[pIdx].splice(tIdx, 1);
                refreshBoard();
            }
            
            turn = (turn + 1) % 4;
            document.getElementById('turn-txt').innerText = turn === 0 ? "Ø¯ÙˆØ±Ùƒ Ø§Ù„Ø¢Ù†" : `ÙƒÙ…Ø¨ÙŠÙˆØªØ± ${turn} ÙŠÙ„Ø¹Ø¨...`;
            if(turn !== 0) setTimeout(cpuPlay, 1000);
        }
    </script>
</body>
</html>
